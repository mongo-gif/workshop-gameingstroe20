<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ | G-STORE</title>
    <link rel="stylesheet" href="style.css">
</head>

<body data-page="orders">
    <!-- Top Info Bar -->
    <div class="top-bar">
        <div class="container">
            <div class="top-bar-left">
                <a href="tel:021054757">üìû 02-105-4757</a>
                <a href="mailto:info@gstore.com">‚úâÔ∏è info@gstore.com</a>
            </div>
            <div class="top-bar-center">
                ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏≠‡∏ö‡πÄ‡∏Å‡∏°‡∏°‡∏¥‡πà‡∏á‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡πå ‡πÄ‡∏£‡∏≤‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡∏±‡∏ô ‚Äî G-STORE ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡∏π‡πâ‡πÉ‡∏à‡∏™‡∏≤‡∏¢‡πÄ‡∏Å‡∏°‡πÄ‡∏°‡∏≠‡∏£‡πå
            </div>
            <div class="top-bar-right">
                <a href="#">üìç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏Ñ‡∏∏‡∏ì ‚Ä∫</a>
            </div>
        </div>
    </div>

    <!-- Main Header -->
    <div class="main-header">
        <div class="container">
            <div class="logo">
                <a href="index.html">G-<span class="logo-highlight">STORE</span></a>
            </div>
            <div class="search-bar">
                <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...">
                <button class="search-btn">üîç</button>
            </div>
            <div class="header-actions">
                <a href="login.html" id="login-btn" class="header-icon-btn">
                    <span class="icon">üë§</span>
                    <span id="user-display">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</span>
                </a>
                <a href="cart.html" class="header-icon-btn">
                    <span class="icon">üõí</span>
                    <span>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</span>
                    <span class="badge" id="cart-count">0</span>
                </a>
                <button id="logout-btn" onclick="logout()" class="btn btn-outline hidden">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            </div>
        </div>
    </div>

    <!-- Navigation Bar -->
    <nav class="nav-bar">
        <div class="container">
            <button class="category-dropdown-btn" onclick="window.location.href='index.html#categories'">
                ‚ò∞ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‚Ä∫
            </button>
            <ul class="nav-links">
                <li><a href="index.html">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
                <li><a href="index.html#products">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a></li>
                <li><a href="index.html#categories">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</a></li>
                <li><a href="#">‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</a></li>
                <li><a href="#">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a></li>
                <li><a href="#">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a></li>
            </ul>
        </div>
    </nav>

    <!-- Orders Content -->
    <section class="orders-section">
        <div class="container">
            <div class="section-title">
                <span class="title-icon">üìã</span>
                <h2>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h2>
            </div>

            <div id="orders-content">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-bottom">
            <div class="container">
                <p>&copy; 2026 G-STORE Gaming. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (!user) {
                document.getElementById('orders-content').innerHTML = `
                    <div class="empty-state">
                        <span class="empty-icon">üîí</span>
                        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
                        <a href="login.html" class="btn btn-primary">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
                    </div>`;
                return;
            }
            loadOrders();
        });

        async function loadOrders() {
            const container = document.getElementById('orders-content');
            try {
                const response = await fetch(`${API_URL}/orders.php?user_id=${user.id}`);
                const orders = await response.json();

                if (!Array.isArray(orders) || orders.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <span class="empty-icon">üì¶</span>
                            <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
                            <a href="index.html" class="btn btn-primary">üõí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
                        </div>`;
                    return;
                }

                container.innerHTML = orders.map(order => {
                    const statusMap = {
                        'pending': { label: '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', class: 'status-pending', icon: '‚è≥' },
                        'processing': { label: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°', class: 'status-processing', icon: 'üì¶' },
                        'shipped': { label: '‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß', class: 'status-shipped', icon: 'üöö' },
                        'completed': { label: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', class: 'status-completed', icon: '‚úÖ' },
                        'cancelled': { label: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å', class: 'status-cancelled', icon: '‚ùå' }
                    };
                    const st = statusMap[order.status] || statusMap['pending'];
                    const date = new Date(order.created_at).toLocaleDateString('th-TH', {
                        year: 'numeric', month: 'long', day: 'numeric',
                        hour: '2-digit', minute: '2-digit'
                    });

                    let itemsHtml = '';
                    if (order.items && order.items.length > 0) {
                        itemsHtml = order.items.map(item => `
                            <div class="order-item">
                                <img src="${item.image_url || ''}" alt="${item.product_name || ''}" class="order-item-img"
                                     onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 50 50%22><rect fill=%22%23f5f5f5%22 width=%2250%22 height=%2250%22/><text x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 fill=%22%23ccc%22 font-size=%2216%22>üì¶</text></svg>'">
                                <div class="order-item-info">
                                    <span class="order-item-name">${item.product_name || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ #' + item.product_id}</span>
                                    <span class="order-item-detail">x${item.quantity} ¬∑ ‡∏ø${parseFloat(item.price).toLocaleString()}</span>
                                </div>
                            </div>
                        `).join('');
                    }

                    return `
                        <div class="order-card">
                            <div class="order-header">
                                <div class="order-header-left">
                                    <span class="order-number">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ #${order.id}</span>
                                    <span class="order-date">${date}</span>
                                </div>
                                <span class="order-status ${st.class}">${st.icon} ${st.label}</span>
                            </div>
                            <div class="order-items-list">${itemsHtml}</div>
                            <div class="order-footer">
                                <span class="order-total">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: <strong>‡∏ø${parseFloat(order.total_price).toLocaleString()}</strong></span>
                            </div>
                        </div>`;
                }).join('');
            } catch (error) {
                console.error('Error loading orders:', error);
                container.innerHTML = `
                    <div class="empty-state">
                        <span class="empty-icon">üòï</span>
                        <p>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏î‡πâ</p>
                        <button class="btn btn-primary" onclick="loadOrders()">‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
                    </div>`;
            }
        }
    </script>
</body>

</html>